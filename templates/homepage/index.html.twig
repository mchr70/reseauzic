{% extends 'base.html.twig' %}

{% block title %}Hello HomePageController!{% endblock %}

{% block body %}
    
    {# Check if the array 'users' is not empty #}
    {% if users %}
        {# Check if the user is connected and if he/she has defined his/her zip code #}
        {% if app.user and app.user.zipCode %}
            {% if app.user.genres %}
                {# Looping over the connected user's genres #}
                {% for genre in app.user.genres %}
                    {# For each user #}
                    {% set index = loop.index %}
                    {% for user in users[index] %}
                        {# Hiding the connected user #}
                        {% if app.user != user and user.isActive == 1 %}
                            {# Check if there is at least one user per genre #}
                            {% if users[index]|length > 0 %}
                                <h3>Derniers inscrits dans votre d√©partement ({{ app.user.departement.name }}) en {{ genre.name }}</h3>
                                <li><a href="{{ path('member_profile', {"id":user.id}) }}">{{ user.username }}</a></li>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                {% endfor %}

            {% endif %}

        {% else %}

        {% endif %}
        
    {% else %}
        Pas encore d'inscrits
    {% endif %}

{% endblock %}
